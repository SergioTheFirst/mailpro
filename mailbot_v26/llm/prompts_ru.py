"""Строгие промпты и триггеры для управляемого суммаризатора."""

# ==========================================================
# ТРИГГЕРЫ ТИПОВ ПИСЕМ (100+ ключевых слов)
# ==========================================================

TRIGGERS = {
    "BANK": [
        "банк", "банковская выписка", "счет", "счёт", "оплата по счету", "инкассация", "платеж", "платёж", "аккредитив",
        "списание", "зачисление", "остаток", "баланс", "ставка", "кредит", "депозит", "автоплатеж", "комиссия",
        "swift", "iban", "reconciliation", "payment advice", "statement", "bank wire", "merchant", "refund", "chargeback"
    ],
    "TAX_FNS": [
        "фнс", "налог", "камеральная", "выездная проверка", "налоговая", "уплата налога", "пени", "штраф", "декларация",
        "ндс", "ндфл", "налог на прибыль", "сверка", "требование", "акт", "инспекция", "fns", "tax authority", "vat",
        "notice of assessment", "tax return", "deduction", "tax due"
    ],
    "COURT": [
        "суд", "арбитраж", "иск", "решение суда", "повестка", "определение", "представление", "дело", "судебный приказ",
        "исполнительный лист", "апелляция", "кассация", "судебное заседание", "hearing", "court", "lawsuit", "claim",
        "statement of claim", "subpoena", "judgement", "ruling", "enforcement"
    ],
    "DOMAIN": [
        "домен", "регистрация домена", "продлить домен", "истекает домен", "dns", "ssl", "сертификат", "whois", "регистратор",
        "expiration", "expires", "renewal", "domain renewal", "registry", "nic.ru", "reg.ru", "cloudflare", "ns записи",
        "transfer", "delegation", "hosting"
    ],
    "HR": [
        "кадры", "hr", "резюме", "вакансия", "кандидат", "собеседование", "оффер", "трудовой договор", "приказ",
        "отпуск", "командировка", "штатное расписание", "перевод", "увольнение", "staffing", "hiring", "interview",
        "cv", "resume", "benefits", "payroll", "onboarding", "probation", "vacation"
    ],
    "LOGISTICS": [
        "доставка", "отгрузка", "накладная", "трек", "track", "shipment", "invoice packing", "logistics", "маршрут",
        "склад", "складской", "курьер", "транспорт", "экспедитор", "waybill", "bill of lading", "cargo", "container",
        "forwarder", "pickup", "delivery", "warehouse", "customs", "broker"
    ],
    "LEGAL": [
        "договор", "контракт", "соглашение", "оферта", "устав", "протокол", "претензия", "юридическое", "право",
        "исковое", "согл", "addendum", "agreement", "nda", "memorandum", "assignment", "amendment", "power of attorney",
        "license", "policy", "terms", "conditions"
    ],
    "INVOICE": [
        "счет", "счёт", "invoice", "оплата", "к оплате", "bill", "оплатить", "счет-фактура", "оплачено", "сумма",
        "act of acceptance", "оплатить до", "оплата счета", "payment request", "оплата услуг", "receipt", "prepayment",
        "closing document", "акт", "универсальный передаточный документ"
    ],
    "DEADLINE": [
        "срок", "истекает", "не позднее", "до", "deadline", "due date", "срочно", "крайний срок", "последний день",
        "конечный срок", "expiry", "дата истечения", "истекает срок", "urgently", "time limit", "дата завершения",
        "cutoff", "timeframe"
    ],
    "NOTIFICATION": [
        "уведомление", "сообщаем", "информируем", "notice", "notification", "информируем вас", "письмо-уведомление",
        "письмо уведомление", "извещаем", "message", "alert", "system notice", "update available", "service notice",
        "maintenance", "downtime", "outage", "status update"
    ],
    "SPAM": [
        "реклама", "sale", "скидк", "offer", "buy now", "discount", "promo", "limited offer", "subscribe", "newsletter",
        "advertisement", "marketing", "seo", "promotion", "lead", "traffic", "spam", "lottery", "casino", "bet", "prize"
    ],
    "GENERIC": [
        "письмо", "сообщение", "информация", "general", "message", "info", "update", "обновление", "подтверждение",
        "confirm", "reminder", "note", "communication", "correspondence", "вопрос", "ответ", "clarification", "support",
        "ticket", "request"
    ],
    "IT": [
        "инцидент", "ticket", "bug", "issue", "ошибка", "сбой", "поддержка", "support case", "jira", "servicedesk",
        "backup", "restore", "patch", "release", "deploy", "deploying", "database", "server", "infrastructure",
        "security alert", "firewall", "antivirus", "vpn", "ssl", "certificate", "endpoint"
    ],
    "SECURITY": [
        "безопасность", "security", "fraud", "подозрительная", "подозрение", "доступ", "access", "unauthorized",
        "пароль", "password", "двухфактор", "2fa", "otp", "код", "verification", "phishing", "malware", "breach",
        "data leak", "compromise", "suspicious", "alert"
    ],
    "MEETING": [
        "встреча", "совещание", "митинг", "call", "zoom", "teams", "webex", "calendar", "appointment", "agenda",
        "minutes", "протокол встречи", "созвон", "meeting", "invite", "invitation", "dial-in", "link", "recording",
        "schedule", "reschedule", "postpone"
    ],
    "REPORT": [
        "отчет", "отчёт", "report", "analytics", "statistic", "показатели", "kpi", "metrics", "ежемесячный", "ежегодный",
        "weekly", "monthly", "quarterly", "summary", "dashboard", "performance", "results", "review", "analysis",
        "data extract", "csv", "xls", "analytics update"
    ],
}

# ==========================================================
# АНТИГАЛЛЮЦИНАЦИОННЫЕ БАЗОВЫЕ ПРОМПТЫ
# ==========================================================

EMAIL_CHUNK = """
Ты анализируешь фрагмент делового письма.

Требования:
- Используй только факты из текста.
- Не придумывай суммы, даты, номера.
- Если фактов нет, верни пустой ответ.
- 1–2 коротких предложения.
- Без эмоций и украшений. Без эмодзи.

Текст:
{text}
"""

EMAIL_MERGE = """
Перед тобой краткие описания одного письма.

Требования:
- Объедини без добавления новых фактов.
- Удали повторы и воду.
- Если сведений мало, оставь итог пустым.
- 2–4 предложения.
- Никаких домыслов.

Фрагменты:
{summaries}
"""

# ==========================================================
# ФИНАЛЬНЫЕ ПРОМПТЫ ПО ТИПАМ ПИСЕМ
# ==========================================================

FINAL_PROMPTS = {
    "BANK": """
Это банковское письмо.

Инструкции:
- Опиши, что сообщает банк и нужно ли действие.
- Не указывай числа, если их нет в тексте.
- 2–3 деловых предложения.
- Без эмоций и эмодзи.

Текст:
{summary}
""",
    "TAX_FNS": """
Это письмо от налогового органа.

Инструкции:
- Что требует или сообщает налоговая.
- Нужны ли ответ или оплата.
- 2–3 предложения, только по тексту.
- Без предположений.

Текст:
{summary}
""",
    "COURT": """
Это судебное письмо.

Инструкции:
- Тип документа и стадия процесса.
- Какое действие нужно.
- 2–4 предложения.
- Не додумывай факты.

Текст:
{summary}
""",
    "DOMAIN": """
Это письмо о домене или сертификате.

Инструкции:
- Что происходит с доменом или сертификатом.
- Есть ли срок или требуемое действие.
- 2–3 предложения.

Текст:
{summary}
""",
    "HR": """
Это кадровое письмо.

Инструкции:
- Суть обращения: вакансия, сотрудник, отпуск и т.п.
- Нужно ли подтвердить, ответить или подписать.
- 2–3 предложения.

Текст:
{summary}
""",
    "LOGISTICS": """
Это письмо по логистике или доставке.

Инструкции:
- Что отправляется или получено.
- Каков статус и требуются ли действия.
- 2–3 предложения.

Текст:
{summary}
""",
    "LEGAL": """
Это юридическое письмо или договор.

Инструкции:
- Тип документа и его назначение.
- Нужны ли подпись или согласование.
- 2–4 предложения.

Текст:
{summary}
""",
    "INVOICE": """
Это письмо со счетом или документами по оплате.

Инструкции:
- Что нужно оплатить или подтвердить.
- Есть ли срок или сумма в тексте.
- 2–3 предложения.

Текст:
{summary}
""",
    "DEADLINE": """
Это письмо о сроках.

Инструкции:
- Какой срок указан и к чему он относится.
- Нужно ли действие до срока.
- 2–3 предложения.

Текст:
{summary}
""",
    "NOTIFICATION": """
Это уведомление.

Инструкции:
- О чем уведомление.
- Нужно ли действие.
- 2–3 предложения без домыслов.

Текст:
{summary}
""",
    "SPAM": """
Это рекламное или нерелевантное письмо.

Инструкции:
- Одним предложением укажи, что письмо рекламное или неважное.
- Не добавляй деталей, которых нет.

Текст:
{summary}
""",
    "GENERIC": """
Это обычное деловое письмо.

Инструкции:
- Кратко объясни суть письма.
- Укажи, требуется ли действие.
- 2–4 предложения без домыслов.

Текст:
{summary}
""",
    "IT": """
Это письмо о технических работах или инциденте.

Инструкции:
- Что за инцидент или изменение.
- Есть ли влияние на сервисы и требуются ли действия.
- 2–3 предложения.

Текст:
{summary}
""",
    "SECURITY": """
Это письмо о безопасности.

Инструкции:
- В чем заключается предупреждение или риск.
- Какие меры предлагаются.
- 2–3 предложения.

Текст:
{summary}
""",
    "MEETING": """
Это приглашение или итоги встречи.

Инструкции:
- Когда и по какой теме встреча или что обсуждалось.
- Что ожидается от получателя.
- 2–3 предложения.

Текст:
{summary}
""",
    "REPORT": """
Это письмо с отчетом или аналитикой.

Инструкции:
- Какие данные или период охвачены.
- Есть ли ключевые выводы или действия.
- 2–3 предложения.

Текст:
{summary}
""",
}

# ==========================================================
# ПРОМПТЫ ДЛЯ ВЛОЖЕНИЙ ПО ТИПАМ ФАЙЛОВ
# ==========================================================

ATTACHMENT_CHUNK_PDF = """
Ты анализируешь фрагмент текста PDF-документа.

Требования:
- Определи, что это за документ и зачем он.
- Используй только факты из фрагмента.
- 1–2 предложения без домыслов.
- Без эмодзи.

Текст:
{text}
"""

ATTACHMENT_CHUNK_EXCEL = """
Ты анализируешь фрагмент таблицы.

Требования:
- Опиши, какие данные содержит таблица.
- Не вычисляй и не придумывай значения.
- 1–2 предложения без эмодзи.

Текст:
{text}
"""

ATTACHMENT_CHUNK_CONTRACT = """
Ты анализируешь фрагмент договора или соглашения.

Требования:
- Определи тип договора и предмет.
- Не делай юридических выводов.
- 1–2 предложения без эмодзи.

Текст:
{text}
"""

ATTACHMENT_CHUNK_GENERIC = """
Ты анализируешь фрагмент вложения.

Требования:
- Кратко опиши содержание фрагмента.
- Не добавляй детали вне текста.
- 1–2 предложения.

Текст:
{text}
"""

ATTACHMENT_MERGE = """
Объедини описания вложения.

Требования:
- Что это за документ и в чем его смысл.
- Без лишних деталей.
- 1–3 предложения.

Фрагменты:
{summaries}
"""
